<!DOCTYPE html>
<html lang="en">
<script src="FRVSE.js"></script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Map</title>
    <style>
        #pixelMap {
            width: 320px;
            height: 200px;
            border: 1px solid black;
        }
        .pixel {
            width: 1px;
            height: 1px;
            float: left;
        }
    </style>
</head>
<body>
	<head>FRVSE - Franto RISC-V Simple Emulator (RISCV32IM)</head>
	
	<div id="screenid">
		<div id="pixelMap"></div>
		<button type="button" onclick="start_frvse()">Start FRVSE</button>
		<button type="button" onclick="stop_frvse()">Stop FRVSE</button>
		<button type="button" onclick="step_frvse()">Step FRVSE</button>
		<button type="button" onclick="reset_frvse()">Reset FRVSE</button>
		<input type="file" id="rom_fileid" name="rom_file"/>
		<input type="file" id="mm_fileid" name="mm_file"/>
	</div>

	<div id="register_table">
		<table>
			<tr>
				<td><button type="button">DEC</button></th>
				<td><button type="button">HEX</button></th>
			</tr>
			<tr>
				<td>PC</td>
				<td>0x0</td>
			</tr>
			<tr>
				<th>Name</th>
				<th>Value</th>
				<th>Name</th>
				<th>Value</th>
			</tr>
			<tr>
				<td>x0 zero</td>
				<td>0x0</td>
				<td>x1 ra</td>
				<td>0x0</td>
			</tr>
		</table>
	</div>

    <script>
	let fileInput = document.getElementById('rom_fileid');
	fileInput.addEventListener('change', (event) => {
		let file = event.target.files[0];

		if(file.size > ROM_MEMORY_SIZE)
		{
			ERROR_MESSAGE = "ERROR: ROM file uploaded is too big. limit is "+ROM_MEMORY_SIZE+ " bytes, file uploaded is "+file.size+" bytes";
			return;
		}

		if (file) {
			let reader = new FileReader();

			reader.onload = function(event) {
				let arrayBuffer = event.target.result;
				let uint8Array = new Uint8Array(arrayBuffer);
				ROM_MEMORY = uint8Array;
			};

			reader.onerror = function() {
				console.error('Error reading file:', reader.error);
			};

			reader.readAsArrayBuffer(file);
		}
	});
	
		/*
        // Function to generate a random color in RGB format
        function getRandomColor() {
            var r = Math.floor(Math.random() * 256);
            var g = Math.floor(Math.random() * 256);
            var b = Math.floor(Math.random() * 256);
            return "rgb(" + r + "," + g + "," + b + ")";
        }

        // Function to create the pixel map
        function createPixelMap() {
            var pixelMap = document.getElementById("pixelMap");
            for (var i = 0; i < 320 * 200; i++) {
                var pixel = document.createElement("div");
                pixel.className = "pixel";
                pixelMap.appendChild(pixel);
            }
            updatePixelColors(); // Initially fill colors
        }

        // Function to update the colors of all pixels
        function updatePixelColors() {
            var pixels = document.querySelectorAll(".pixel");
            pixels.forEach(function(pixel) {
                pixel.style.backgroundColor = getRandomColor();
            });
        }

        // Call the function to create the pixel map
        createPixelMap();

        // Infinite cycle to update pixel colors
        setInterval(updatePixelColors, 100); // Change color every 100 milliseconds
		*/
    </script>
</body>
</html>
